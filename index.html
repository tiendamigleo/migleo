<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="Tienda de moda infantil especializada en vestidos para niñas y ternos para niños de alta calidad en Perú">
    <link rel="icon" type="image/x-icon" href="FOTO/ICONO/icono_01.ico">    
    <title>Migleo - Moda Infantil</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Reset mejorado y variables CSS */
        :root {
            --primary-color: #ff6b8b;
            --primary-dark: #e05573;
            --secondary-color: #6a5af9;
            --secondary-dark: #5549d4;
            --accent-color: #4ecdc4;
            --accent-dark: #3ab4ac;
            --dark-color: #2d3047;
            --dark-light: #3a3e5c;
            --light-color: #f9f9f9;
            --gray-light: #f5f5f5;
            --gray-medium: #e0e0e0;
            --gray-dark: #8a8a8a;
            --text-color: #2c2c2c;
            --text-light: #5a5a5a;
            --success-color: #4CAF50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 12px 32px rgba(0, 0, 0, 0.15);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-full: 50%;
            
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            
            --header-height: 80px;
            --mobile-menu-height: 65px;
            --container-padding: clamp(16px, 4vw, 24px);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            font-size: 16px;
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--light-color);
            color: var(--text-color);
            line-height: 1.6;
            font-weight: 400;
            padding-bottom: var(--mobile-menu-height);
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* Mejoras de accesibilidad */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        :focus-visible {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
            border-radius: var(--radius-sm);
        }
        
        /* Mejoras de tipografía */
        h1, h2, h3, h4 {
            font-family: 'Poppins', 'Inter', sans-serif;
            font-weight: 600;
            line-height: 1.3;
            color: var(--dark-color);
        }
        
        p {
            margin-bottom: 1rem;
        }
        
        a {
            color: var(--secondary-color);
            text-decoration: none;
            transition: color var(--transition-fast);
        }
        
        a:hover, a:focus {
            color: var(--secondary-dark);
        }
        
        /* Contenedores mejorados */
        .container {
            width: 100%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 var(--container-padding);
        }
        
        /* HEADER MEJORADO */
        header {
            background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%);
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: var(--header-height);
            display: flex;
            align-items: center;
            border-bottom: 3px solid var(--primary-color);
        }
        
        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            gap: 16px;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 16px;
            min-width: 0;
            flex-shrink: 0;
        }
        
        .logo-image {
            height: 60px;
            border-radius: 12px;
            object-fit: cover;
        }
        
        .logo-text h1 {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark-color);
            line-height: 1.2;
            margin-bottom: 4px;
        }
        
        .logo-text span {
            display: block;
            font-size: 0.8rem;
            color: var(--primary-color);
            font-weight: 500;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Búsqueda mejorada - POSICIÓN CENTRAL */
        .search-section {
            flex: 1;
            max-width: 600px;
            margin: 0 20px;
            position: relative;
        }
        
        .search-container {
            position: relative;
            width: 100%;
        }
        
        .search-input-wrapper {
            position: relative;
            width: 100%;
        }
        
        .search-input {
            width: 100%;
            padding: 16px 24px 16px 52px;
            border: 2px solid var(--gray-medium);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            background-color: white;
            transition: all var(--transition-normal);
            font-family: 'Inter', sans-serif;
            color: var(--text-color);
            box-shadow: var(--shadow-sm);
        }
        
        .search-input:focus {
            border-color: var(--primary-color);
            background-color: white;
            box-shadow: 0 0 0 4px rgba(255, 107, 139, 0.15);
            outline: none;
        }
        
        .search-input::placeholder {
            color: var(--gray-dark);
            font-weight: 400;
        }
        
        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 1.1rem;
            pointer-events: none;
        }
        
        .search-hint {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background-color: var(--gray-light);
            color: var(--text-light);
            font-size: 0.8rem;
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            opacity: 0;
            transition: opacity var(--transition-normal);
            pointer-events: none;
        }
        
        .search-input:focus + .search-hint {
            opacity: 1;
        }
        
        .search-results {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background-color: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            border: 1px solid var(--gray-medium);
        }
        
        .search-results.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .search-result-item {
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-light);
            cursor: pointer;
            transition: background-color var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .search-result-item:hover {
            background-color: var(--gray-light);
        }
        
        .search-result-item img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .search-result-info h4 {
            font-size: 0.95rem;
            margin-bottom: 4px;
        }
        
        .search-result-info p {
            font-size: 0.85rem;
            color: var(--text-light);
            margin: 0;
        }
        
        .search-result-price {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .no-results {
            padding: 20px;
            text-align: center;
            color: var(--text-light);
        }
        
        /* Acciones del header - OCULTAS EN MÓVIL */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }
        
        .header-icon {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            box-shadow: var(--shadow-sm);
        }
        
        .header-icon:hover, .header-icon:focus {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        .header-icon.whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
        }
        
        .header-icon-text {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--error-color);
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            min-width: 20px;
            height: 20px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5px;
        }
        
        /* Botón de búsqueda móvil */
        .mobile-search-toggle {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            font-size: 1.2rem;
            color: white;
            padding: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-fast);
        }
        
        .mobile-search-toggle:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        /* MEJORA: Hero section más atractiva */
        .hero {
            background: linear-gradient(135deg, 
                rgba(255, 107, 139, 0.85) 0%, 
                rgba(106, 90, 249, 0.85) 100%),
                url('https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding: 100px 0;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            border-radius: 0 0 40px 40px;
            box-shadow: var(--shadow-xl);
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 50%);
            animation: pulse 4s ease-in-out infinite alternate;
        }
        
        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }
        
        .hero h2 {
            font-size: clamp(2.2rem, 6vw, 3.5rem);
            color: white;
            margin-bottom: 25px;
            text-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            line-height: 1.2;
            animation: fadeInUp 1s ease-out;
        }
        
        .hero p {
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            opacity: 0.95;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            animation: fadeInUp 1s ease-out 0.3s both;
        }
        
        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 50px;
            animation: fadeInUp 1s ease-out 0.6s both;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            display: block;
            margin-bottom: 5px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            animation: fadeInUp 1s ease-out 0.9s both;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 32px;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all var(--transition-normal);
            border: none;
            text-decoration: none;
            min-height: 56px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-dark));
            color: white;
            box-shadow: var(--shadow-lg);
        }
        
        .btn-primary:hover, .btn-primary:focus {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(78, 205, 196, 0.4);
        }
        
        .btn-secondary {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.4);
        }
        
        .btn-secondary:hover, .btn-secondary:focus {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.2);
        }
        
        @keyframes pulse {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* SOLUCIÓN 3: Barra de filtros fija en top */
        .barra-filtros-fija {
            position: sticky;
            top: var(--header-height);
            background: white;
            z-index: 900;
            padding: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-bottom: 1px solid var(--gray-light);
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.95);
            margin-bottom: 20px;
        }
        
        .filtros-horizontal {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--gray-light);
        }
        
        .filtros-horizontal::-webkit-scrollbar {
            height: 4px;
        }
        
        .filtros-horizontal::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 2px;
        }
        
        .filtros-horizontal::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 2px;
        }
        
        /* Grupos de filtros horizontales */
        .grupo-filtro-horizontal {
            flex-shrink: 0;
            position: relative;
        }
        
        .btn-filtro-grupo {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: var(--gray-light);
            border: 1px solid var(--gray-medium);
            border-radius: var(--radius-lg);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }
        
        .btn-filtro-grupo:hover {
            background: var(--gray-medium);
        }
        
        .btn-filtro-grupo.activo {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: var(--primary-color);
        }
        
        /* Dropdown de filtros */
        .filtro-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            min-width: 250px;
            z-index: 1000;
            display: none;
            padding: 20px;
            margin-top: 5px;
            border: 1px solid var(--gray-medium);
        }
        
        .filtro-dropdown.visible {
            display: block;
            animation: fadeInDown 0.3s ease;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* SOLUCIÓN 4: Sistema de Chips para Filtros Activos */
        .filtros-chips-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }
        
        .filtros-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            flex: 1;
        }
        
        .filtro-chip {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-dark));
            color: white;
            border-radius: 20px;
            font-size: 0.9rem;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .chip-remove {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 2px;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .chip-remove:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .filtros-info {
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .btn-link {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-weight: 500;
            padding: 5px 10px;
            border-radius: var(--radius-sm);
            transition: background 0.2s;
        }
        
        .btn-link:hover {
            background: rgba(255, 107, 139, 0.1);
        }
        
        /* SOLUCIÓN 2: Filtros en Overlay para Móvil */
        .filtros-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .filtros-overlay.activo {
            display: flex;
            opacity: 1;
            align-items: flex-start;
            justify-content: flex-start;
        }
        
        .filtros-contenedor-movil {
            width: 85%;
            max-width: 400px;
            height: 100vh;
            background: white;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
        }
        
        .filtros-overlay.activo .filtros-contenedor-movil {
            transform: translateX(0);
        }
        
        /* Botón flotante para abrir filtros en móvil */
        .btn-filtros-flotante {
            position: fixed;
            bottom: 90px; /* Encima del menú móvil */
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-filtros-flotante:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
        }
        
        .btn-filtros-flotante .contador {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error-color);
            color: white;
            font-size: 0.8rem;
            min-width: 22px;
            height: 22px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Filtros originales (ocultos en móvil) */
        .filters-container {
            margin-bottom: 30px;
        }
        
        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 24px;
            background-color: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            margin-bottom: 2px;
        }
        
        .filters-header:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .filters-header h3 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
            color: var(--dark-color);
        }
        
        .filters-content {
            background-color: white;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            box-shadow: var(--shadow-md);
            max-height: 0;
            overflow: hidden;
            transition: max-height var(--transition-normal);
        }
        
        .filters-content.active {
            max-height: 800px;
            padding: 24px;
            overflow-y: auto;
        }
        
        /* Grid de filtros responsive */
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .filter-group {
            background-color: var(--gray-light);
            border-radius: var(--radius-sm);
            padding: 20px;
        }
        
        .filter-group h4 {
            margin-bottom: 16px;
            font-size: 1rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .filter-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: var(--radius-sm);
            transition: background-color var(--transition-fast);
            cursor: pointer;
        }
        
        .filter-option:hover {
            background-color: rgba(106, 90, 249, 0.05);
        }
        
        .filter-option input {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }
        
        .color-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .color-option {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            border: 2px solid white;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }
        
        .color-option:hover, .color-option.selected {
            transform: scale(1.2);
            box-shadow: var(--shadow-md);
        }
        
        .color-option[data-color="rosado"] { background-color: #ff6b8b; }
        .color-option[data-color="azul"] { background-color: #6a5af9; }
        .color-option[data-color="blanco"] { 
            background-color: #ffffff; 
            border: 1px solid #ddd;
        }
        .color-option[data-color="negro"] { background-color: #2d3047; }
        .color-option[data-color="rojo"] { background-color: #ff4757; }
        .color-option[data-color="amarillo"] { background-color: #ffd700; }
        .color-option[data-color="verde"] { background-color: #2ed573; }
        .color-option[data-color="multicolor"] { 
            background: linear-gradient(45deg, #ff6b8b, #6a5af9, #4ecdc4, #2ed573);
        }
        
        /* Rango de precio mejorado */
        .price-filter {
            padding: 10px 0;
        }
        
        .price-slider {
            width: 100%;
            height: 6px;
            background: var(--gray-medium);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            margin: 20px 0;
        }
        
        .price-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: var(--radius-full);
            background: var(--primary-color);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: var(--shadow-md);
        }
        
        .price-values {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-weight: 500;
        }
        
        /* Botones de filtro mejorados */
        .filter-actions {
            display: flex;
            gap: 16px;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--gray-medium);
        }
        
        .filter-btn {
            flex: 1;
            padding: 16px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .filter-btn.apply {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }
        
        .filter-btn.apply:hover, .filter-btn.apply:focus {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .filter-btn.reset {
            background-color: var(--gray-light);
            color: var(--text-color);
        }
        
        .filter-btn.reset:hover, .filter-btn.reset:focus {
            background-color: var(--gray-medium);
            transform: translateY(-2px);
        }
        
        /* Productos mejorados */
        .products-section {
            margin: 40px 0;
        }
        
        .section-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--gray-light);
        }
        
        .section-title {
            font-size: 1.8rem;
            color: var(--dark-color);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        
        .products-stats {
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        .sort-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .sort-select {
            padding: 12px 16px;
            border-radius: var(--radius-md);
            border: 2px solid var(--gray-medium);
            background-color: white;
            color: var(--text-color);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: border-color var(--transition-fast);
            min-width: 180px;
        }
        
        .sort-select:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        /* Grid de productos mejorado */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }
        
        /* Card de producto mejorada */
        .product-card {
            background-color: white;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            position: relative;
            display: flex;
            flex-direction: column;
            height: 100%;
            border: 1px solid var(--gray-light);
        }
        
        .product-card:hover, .product-card:focus-within {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }
        
        .product-badge {
            position: absolute;
            top: 16px;
            left: 16px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }
        
        .product-badge.nuevo {
            background: linear-gradient(135deg, var(--success-color), #2ecc71);
        }
        
        .product-badge.oferta {
            background: linear-gradient(135deg, var(--error-color), #ff3838);
        }
        
        .product-badge.consultar {
            background: linear-gradient(135deg, var(--warning-color), #ff9f1a);
        }
        
        .product-image-container {
            position: relative;
            overflow: hidden;
            background-color: var(--gray-light);
        }
        
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-slow);
        }
        
        .product-card:hover .product-image {
            transform: scale(1.05);
        }
        
        .product-wishlist {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            background-color: white;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-light);
            cursor: pointer;
            transition: all var(--transition-fast);
            z-index: 2;
            border: none;
            box-shadow: var(--shadow-sm);
        }
        
        .product-wishlist:hover, .product-wishlist.activo {
            color: var(--error-color);
            background-color: #ffeaea;
            transform: scale(1.1);
        }
        
        .product-info {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-category {
            display: inline-block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--secondary-color);
            background-color: rgba(106, 90, 249, 0.1);
            padding: 4px 10px;
            border-radius: var(--radius-full);
            margin-bottom: 12px;
            align-self: flex-start;
        }
        
        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark-color);
            line-height: 1.4;
            flex-grow: 1;
        }
        
        .product-description {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 16px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .product-price-container {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .product-price {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .product-price.consultar {
            font-size: 1.2rem;
            color: var(--warning-color);
            font-weight: 600;
        }
        
        .product-price.antiguo {
            font-size: 1rem;
            color: var(--gray-dark);
            text-decoration: line-through;
            font-weight: 500;
        }
        
        .product-colors {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        
        .product-color-dot {
            width: 20px;
            height: 20px;
            border-radius: var(--radius-full);
            border: 2px solid white;
            box-shadow: var(--shadow-sm);
        }
        
        .product-sizes {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .size-option {
            padding: 6px 12px;
            border: 1px solid var(--gray-medium);
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            background-color: white;
            min-width: 40px;
            text-align: center;
        }
        
        .size-option:hover, .size-option.seleccionado {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .product-actions {
            display: flex;
            gap: 12px;
            margin-top: auto;
        }
        
        .product-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .product-btn.asesor {
            background: linear-gradient(135deg, var(--dark-color), var(--dark-light));
            color: white;
        }
        
        .product-btn.asesor:hover, .product-btn.asesor:focus {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .product-btn.consultar {
            background: linear-gradient(135deg, var(--warning-color), #ff9f1a);
            color: white;
        }
        
        .product-btn.consultar:hover, .product-btn.consultar:focus {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .product-btn.view {
            background-color: var(--gray-light);
            color: var(--text-color);
        }
        
        .product-btn.view:hover, .product-btn.view:focus {
            background-color: var(--gray-medium);
            transform: translateY(-2px);
        }
        
        /* Paginación */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .page-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            border: 1px solid var(--gray-medium);
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 500;
        }
        
        .page-btn:hover, .page-btn.active {
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
            color: white;
            border-color: var(--secondary-color);
        }
        
        .page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Modal para seleccionar talla y color */
        .seleccion-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .seleccion-modal.activo {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        /* Menú móvil mejorado */
        .mobile-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            height: var(--mobile-menu-height);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 10px;
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.97);
            border-top: 1px solid var(--gray-light);
        }
        
        .mobile-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 12px 8px;
            border-radius: var(--radius-md);
            text-decoration: none;
            color: var(--text-light);
            transition: all var(--transition-fast);
            flex: 1;
            max-width: 80px;
            min-height: 56px;
            position: relative;
        }
        
        .mobile-menu-item.active, .mobile-menu-item:focus {
            color: var(--primary-color);
            background-color: rgba(255, 107, 139, 0.1);
        }
        
        .mobile-menu-item i {
            font-size: 1.3rem;
        }
        
        .mobile-menu-item span {
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .mobile-menu-badge {
            position: absolute;
            top: 8px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            font-size: 0.7rem;
            min-width: 18px;
            height: 18px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
        }
        
        /* Modal de asesores */
        .asesores-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .asesores-modal.activo {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.3s ease;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gray-light);
        }
        
        .modal-header h3 {
            font-size: 1.5rem;
            color: var(--dark-color);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--gray-dark);
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .modal-close:hover {
            background-color: var(--gray-light);
            color: var(--dark-color);
        }
        
        .asesor-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            transition: all var(--transition-fast);
        }
        
        .asesor-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .asesor-avatar {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-full);
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }
        
        .asesor-info h4 {
            margin-bottom: 4px;
            font-size: 1.1rem;
        }
        
        .asesor-info p {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 8px;
        }
        
        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-whatsapp:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        /* Productos para consulta */
        .productos-consulta {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--gray-light);
            border-radius: var(--radius-md);
        }
        
        .producto-consulta-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: white;
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
        }
        
        .producto-consulta-item img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .producto-consulta-info {
            flex: 1;
        }
        
        .producto-consulta-info h5 {
            font-size: 0.9rem;
            margin-bottom: 4px;
        }
        
        .producto-consulta-info p {
            font-size: 0.8rem;
            color: var(--text-light);
            margin: 0;
        }
        
        .producto-consulta-remover {
            background: none;
            border: none;
            color: var(--error-color);
            cursor: pointer;
            padding: 5px;
            border-radius: var(--radius-full);
        }
        
        /* Modal de lista de favoritos */
        .favoritos-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .favoritos-modal.activo {
            display: flex;
        }
        
        .favoritos-list {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .favorito-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .favorito-item:last-child {
            border-bottom: none;
        }
        
        .favorito-item img {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-sm);
            object-fit: cover;
        }
        
        .favorito-info {
            flex: 1;
        }
        
        .favorito-info h4 {
            font-size: 1rem;
            margin-bottom: 4px;
        }
        
        .favorito-info p {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }
        
        .favorito-price {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .favorito-remove {
            background: none;
            border: none;
            color: var(--error-color);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 8px;
            border-radius: var(--radius-full);
            transition: all var(--transition-fast);
        }
        
        .favorito-remove:hover {
            background-color: rgba(244, 67, 54, 0.1);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Responsive mejorado */
        @media (max-width: 992px) {
            .search-section {
                max-width: 400px;
                margin: 0 10px;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding-bottom: var(--mobile-menu-height);
            }
            
            .mobile-menu {
                display: flex;
            }
            
            .search-section {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background-color: white;
                padding: 15px;
                box-shadow: var(--shadow-lg);
                z-index: 999;
                margin: 0;
                max-width: none;
                transform: translateY(-100%);
                transition: transform 0.3s ease;
            }
            
            .search-section.active {
                display: block;
                transform: translateY(0);
                animation: slideDown 0.3s ease;
            }
            
            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translateY(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .header-actions {
                display: none;
            }
            
            .mobile-search-toggle {
                display: flex;
            }
            
            .header-container {
                justify-content: space-between;
            }
            
            .hero {
                padding: 60px 0;
                border-radius: 0 0 30px 30px;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .hero-stats {
                flex-direction: column;
                gap: 20px;
                margin-top: 30px;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            /* Mostrar botón flotante de filtros en móvil */
            .btn-filtros-flotante {
                display: flex;
            }
            
            /* Ocultar barra de filtros fija en móvil */
            .barra-filtros-fija {
                display: none;
            }
            
            /* Ocultar filtros originales en móvil */
            .filters-container {
                display: none;
            }
            
            .filters-content.active {
                padding: 20px;
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (min-width: 769px) {
            body {
                padding-bottom: 0;
            }
            
            .mobile-menu {
                display: none;
            }
            
            .mobile-search-toggle {
                display: none;
            }
            
            .header-actions {
                display: flex;
            }
            
            /* Ocultar botón flotante de filtros en desktop */
            .btn-filtros-flotante {
                display: none;
            }
        }
        
        @media (min-width: 1024px) {
            .filter-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (min-width: 1280px) {
            .products-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        /* Utilidades */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-full);
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--dark-color);
            color: white;
            padding: 16px 24px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-xl);
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideUp 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
        }
        
        @keyframes fadeOut {
            to { opacity: 0; transform: translateX(-50%) translateY(20px); }
        }
        
        /* Indicador de carga para búsqueda */
        .search-loading {
            display: none;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
        }
        
        .search-loading.active {
            display: block;
            animation: spin 1s linear infinite;
        }
        
        /* Estado vacío para favoritos */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }
        
        .empty-state i {
            font-size: 3rem;
            color: var(--gray-medium);
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-state h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--text-light);
        }
        
        .empty-state p {
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        /* MEJORA: Contenedor de selección de talla/color */
        .seleccion-opciones {
            padding: 20px;
            background: white;
            border-radius: var(--radius-md);
            max-width: 400px;
            width: 100%;
        }
        
        .seleccion-titulo {
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: var(--dark-color);
        }
        
        .seleccion-grupo {
            margin-bottom: 20px;
        }
        
        .seleccion-grupo h4 {
            margin-bottom: 10px;
            font-size: 1rem;
            color: var(--dark-color);
        }
        
        .seleccion-acciones {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }
        
        .seleccion-acciones .btn {
            flex: 1;
        }
    </style>
</head>
<body>
    <!-- Header mejorado -->
    <header>
        <div class="container header-container">
            <div class="logo-container">
                <img src="FOTO/LOGO/logo_01.png" 
                     alt="Logo Moda Infantil Elegante" class="logo-image">
            </div>
            
            <!-- Búsqueda mejorada en posición central -->
            <div class="search-section" id="search-section">
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <input type="text" class="search-input" id="search-input" 
                               placeholder="Buscar vestidos, ternos, accesorios..." 
                               aria-label="Buscar productos">
                        <i class="fas fa-search search-icon" aria-hidden="true"></i>
                        <span class="search-hint">Presiona Enter para buscar</span>
                        <i class="fas fa-spinner search-loading" id="search-loading"></i>
                    </div>
                    <div class="search-results" id="search-results">
                        <!-- Resultados dinámicos -->
                    </div>
                </div>
            </div>
            
            <div class="header-actions">
                <!-- Botón de búsqueda para móvil -->
                <button class="mobile-search-toggle" id="mobile-search-toggle" 
                        aria-label="Abrir búsqueda">
                    <i class="fas fa-search"></i>
                </button>
                
                <!-- Favoritos -->
                <button class="header-icon" id="header-favoritos" aria-label="Ver favoritos">
                    <i class="fas fa-heart"></i>
                    <span class="header-icon-text" id="favoritos-count">0</span>
                </button>
                
                <!-- Asesor de ventas -->
                <button class="header-icon whatsapp" id="header-asesor" aria-label="Contactar asesor">
                    <i class="fab fa-whatsapp"></i>
                    <span class="header-icon-text" id="asesor-count">0</span>
                </button>
                
                <!-- Usuario -->
                <a href="#" class="header-icon" aria-label="Mi cuenta">
                    <i class="fas fa-user"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- MEJORA: Hero section más atractiva -->
    <section class="hero" aria-label="Bienvenida">
        <div class="hero-content">
            <h2>Elegancia Infantil en Cada Detalle</h2>
            <p>Descubre nuestra exclusiva colección de vestidos para niñas y ternos para niños, diseñados con amor y atención al detalle para ocasiones especiales en Perú.</p>
            <div class="cta-buttons">
                <a href="#products" class="btn btn-primary">
                    <i class="fas fa-shopping-bag"></i> Ver Colección
                </a>
                <a href="#new-arrivals" class="btn btn-secondary">
                    <i class="fas fa-star"></i> Nuevos Ingresos
                </a>
            </div>
            <div class="hero-stats">
                <div class="stat-item">
                    <span class="stat-number">50+</span>
                    <span class="stat-label">Diseños Únicos</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">100%</span>
                    <span class="stat-label">Calidad Garantizada</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">24/7</span>
                    <span class="stat-label">Asesoría Personalizada</span>
                </div>
            </div>
        </div>
    </section>

    <!-- SOLUCIÓN 3: Barra de filtros fija -->
    <div class="barra-filtros-fija" id="barra-filtros">
        <div class="container">
            <div class="filtros-horizontal">
                <div class="grupo-filtro-horizontal">
                    <button class="btn-filtro-grupo" data-target="categoria">
                        <i class="fas fa-tshirt"></i> Categoría
                    </button>
                </div>
                <div class="grupo-filtro-horizontal">
                    <button class="btn-filtro-grupo" data-target="talla">
                        <i class="fas fa-child"></i> Talla
                    </button>
                </div>
                <div class="grupo-filtro-horizontal">
                    <button class="btn-filtro-grupo" data-target="precio">
                        <i class="fas fa-sol"></i> Precio
                    </button>
                </div>
                <div class="grupo-filtro-horizontal">
                    <button class="btn-filtro-grupo" data-target="color">
                        <i class="fas fa-palette"></i> Color
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- SOLUCIÓN 4: Sistema de Chips para Filtros Activos -->
    <div class="container">
        <div class="filtros-chips-container" id="filtros-chips-container">
            <div class="filtros-chips" id="filtros-activos-chips">
                <!-- Chips dinámicos -->
            </div>
            <div class="filtros-info">
                <span id="productos-filtrados-count">Mostrando todos los productos</span>
                <button class="btn-link" onclick="limpiarTodosFiltros()">
                    Limpiar todos
                </button>
            </div>
        </div>
    </div>

    <!-- SOLUCIÓN 2: Overlay de filtros para móvil -->
    <div class="filtros-overlay" id="filtros-overlay">
        <div class="filtros-contenedor-movil">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3><i class="fas fa-filter"></i> Filtros</h3>
                    <button class="modal-close" onclick="cerrarFiltrosMovil()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <!-- Chips en móvil -->
                <div class="filtros-chips" id="filtros-chips-movil" style="margin-bottom: 20px;"></div>
                
                <!-- Contenido de filtros para móvil -->
                <div id="filtros-content-movil">
                    <!-- Se cargará dinámicamente -->
                </div>
                
                <div class="filter-actions">
                    <button class="filter-btn apply" onclick="aplicarFiltros()">
                        <i class="fas fa-check"></i> Aplicar Filtros
                    </button>
                    <button class="filter-btn reset" onclick="reiniciarFiltros()">
                        <i class="fas fa-redo"></i> Limpiar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Botón flotante para filtros en móvil -->
    <button class="btn-filtros-flotante" id="btn-filtros-movil">
        <i class="fas fa-filter"></i>
        <span class="contador" id="contador-filtros-movil">0</span>
    </button>

    <!-- Filtros originales (solo para desktop) -->
    <div class="container">
        <section class="filters-container" aria-label="Filtros de búsqueda">
            <div class="filters-header" id="filters-toggle" role="button" tabindex="0" aria-expanded="false" aria-controls="filters-content">
                <h3><i class="fas fa-filter"></i> Filtros Avanzados</h3>
                <span class="toggle-icon" aria-hidden="true"><i class="fas fa-chevron-down"></i></span>
            </div>
            <div class="filters-content" id="filters-content" role="region" aria-labelledby="filters-toggle">
                <div class="filter-grid">
                    <!-- Categoría -->
                    <div class="filter-group">
                        <h4><i class="fas fa-tags"></i> Categoría</h4>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="categoria" value="niñas" checked>
                                <span>Vestidos para niñas</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="categoria" value="niños" checked>
                                <span>Ternos para niños</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Tamaño (nuevas tallas) -->
                    <div class="filter-group">
                        <h4><i class="fas fa-child"></i> Talla</h4>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="talla" value="6">
                                <span>Talla 6</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="talla" value="8">
                                <span>Talla 8</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="talla" value="10">
                                <span>Talla 10</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="talla" value="12">
                                <span>Talla 12</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="talla" value="14">
                                <span>Talla 14</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="talla" value="16">
                                <span>Talla 16</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Precio en Soles Peruanos -->
                    <div class="filter-group">
                        <h4><i class="fas fa-sol"></i> Precio (S/)</h4>
                        <div class="price-filter">
                            <input type="range" min="50" max="500" value="500" class="price-slider" id="price-slider" aria-label="Rango de precios">
                            <div class="price-values">
                                <span>S/ <span id="min-price">50</span></span>
                                <span>S/ <span id="max-price">500</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Color -->
                    <div class="filter-group">
                        <h4><i class="fas fa-palette"></i> Color</h4>
                        <div class="color-options">
                            <div class="color-option" data-color="rosado" tabindex="0" role="button" aria-label="Color rosado"></div>
                            <div class="color-option" data-color="azul" tabindex="0" role="button" aria-label="Color azul"></div>
                            <div class="color-option" data-color="blanco" tabindex="0" role="button" aria-label="Color blanco"></div>
                            <div class="color-option" data-color="negro" tabindex="0" role="button" aria-label="Color negro"></div>
                            <div class="color-option" data-color="rojo" tabindex="0" role="button" aria-label="Color rojo"></div>
                            <div class="color-option" data-color="amarillo" tabindex="0" role="button" aria-label="Color amarillo"></div>
                            <div class="color-option" data-color="verde" tabindex="0" role="button" aria-label="Color verde"></div>
                            <div class="color-option" data-color="multicolor" tabindex="0" role="button" aria-label="Color multicolor"></div>
                        </div>
                    </div>
                </div>
                
                <div class="filter-actions">
                    <button class="filter-btn apply" id="apply-filters">
                        <i class="fas fa-check"></i> Aplicar Filtros
                    </button>
                    <button class="filter-btn reset" id="reset-filters">
                        <i class="fas fa-redo"></i> Limpiar Filtros
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- Productos -->
    <div class="container">
        <section class="products-section" id="products" aria-label="Productos">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Nuestra Colección</h2>
                    <p class="products-stats" id="products-stats">Mostrando <span id="products-count">8</span> productos</p>
                </div>
                <div class="sort-container">
                    <label for="sort-select" class="sr-only">Ordenar por</label>
                    <select class="sort-select" id="sort-select" aria-label="Ordenar productos">
                        <option value="destacados">Destacados</option>
                        <option value="precio-bajo">Precio: Menor a Mayor</option>
                        <option value="precio-alto">Precio: Mayor a Menor</option>
                        <option value="nuevos">Más Nuevos</option>
                    </select>
                </div>
            </div>
            
            <div class="products-grid" id="products-grid">
                <!-- Los productos se cargarán dinámicamente -->
            </div>
            
            <!-- Paginación -->
            <div class="pagination" id="pagination" role="navigation" aria-label="Paginación">
                <!-- La paginación se generará dinámicamente -->
            </div>
        </section>
    </div>

    <!-- Modal para seleccionar talla y color -->
    <div class="seleccion-modal" id="seleccion-modal">
        <div class="seleccion-opciones">
            <h3 class="seleccion-titulo" id="seleccion-titulo">Seleccionar talla y color</h3>
            
            <div class="seleccion-grupo">
                <h4><i class="fas fa-child"></i> Talla</h4>
                <div class="product-sizes" id="seleccion-tallas">
                    <!-- Tallas dinámicas -->
                </div>
            </div>
            
            <div class="seleccion-grupo">
                <h4><i class="fas fa-palette"></i> Color</h4>
                <div class="color-options" id="seleccion-colores">
                    <!-- Colores dinámicos -->
                </div>
            </div>
            
            <div class="seleccion-acciones">
                <button class="btn btn-primary" id="confirmar-seleccion">
                    <i class="fas fa-check"></i> Agregar para consultar
                </button>
                <button class="btn btn-secondary" onclick="cerrarSeleccionModal()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para contactar asesores -->
    <div class="asesores-modal" id="asesores-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Contactar a un Asesor</h3>
                <button class="modal-close" id="close-asesores-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Productos agregados para consulta -->
            <div class="productos-consulta" id="productos-consulta-lista">
                <h4>Productos para consultar:</h4>
                <div id="lista-productos-consulta">
                    <!-- Productos dinámicos -->
                </div>
            </div>
            
            <p>Selecciona un asesor para contactar por WhatsApp:</p>
            
            <div id="asesores-list">
                <!-- Asesores se cargarán dinámicamente -->
            </div>
            
            <div class="filter-actions" style="border-top: none; margin-top: 20px;">
                <button class="filter-btn reset" id="cancel-asesor">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de lista de favoritos -->
    <div class="favoritos-modal" id="favoritos-modal" role="dialog" aria-modal="true" aria-labelledby="favoritos-title">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="favoritos-title">Mis Favoritos</h3>
                <button class="modal-close" id="close-favoritos-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="favoritos-list" id="favoritos-list">
                <!-- Los productos favoritos se cargarán dinámicamente -->
            </div>
            
            <div class="filter-actions" style="border-top: none; margin-top: 20px;">
                <button class="filter-btn apply" id="contactar-favoritos">
                    <i class="fab fa-whatsapp"></i> Contactar por Favoritos
                </button>
                <button class="filter-btn reset" id="limpiar-favoritos">
                    <i class="fas fa-trash"></i> Limpiar Favoritos
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de detalles de producto -->
    <div class="asesores-modal" id="detalle-producto-modal" role="dialog" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="detalle-producto-titulo">Detalles del Producto</h3>
                <button class="modal-close" onclick="cerrarDetalleProductoModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="detalle-producto-contenido">
                <!-- Contenido dinámico -->
            </div>
        </div>
    </div>

    <!-- Menú móvil mejorado -->
    <nav class="mobile-menu" aria-label="Navegación móvil">
        <a href="#" class="mobile-menu-item active" aria-label="Inicio" aria-current="page">
            <i class="fas fa-home"></i>
            <span>Inicio</span>
        </a>
        <a href="#products" class="mobile-menu-item" aria-label="Tienda">
            <i class="fas fa-store"></i>
            <span>Tienda</span>
        </a>
        <a href="#" class="mobile-menu-item" aria-label="Buscar" id="mobile-menu-search">
            <i class="fas fa-search"></i>
            <span>Buscar</span>
        </a>
        <a href="#" class="mobile-menu-item" aria-label="Favoritos" id="mobile-menu-favoritos">
            <i class="fas fa-heart"></i>
            <span>Favoritos</span>
            <span class="mobile-menu-badge" id="mobile-favoritos-count">0</span>
        </a>
        <a href="#" class="mobile-menu-item" aria-label="Asesor" id="mobile-menu-asesor">
            <i class="fab fa-whatsapp"></i>
            <span>Asesor</span>
            <span class="mobile-menu-badge" id="mobile-asesor-count">0</span>
        </a>
    </nav>

    <script>
        // Datos de productos mejorados en español
        const productos = [
            {
                id: 1,
                nombre: "Vestido de Gala Rosado con Lazo",
                categoria: "niñas",
                precio: 0,
                precioAnterior: 0,
                imagen: "FOTO/PRODUCTO/PRO-001/2.png",
                tallas: ["6", "8", "10", "12"],
                colores: ["rosado", "blanco"],
                descripcion: "Vestido elegante para ocasiones especiales con lazo decorativo",
                etiqueta: "oferta",
                enFavoritos: false
            },
            {
                id: 2,
                nombre: "Vestido de Tul Blanco con Detalles Dorados",
                categoria: "niñas",
                precio: 0,
                precioAnterior: 0,
                imagen: "FOTO/PRODUCTO/PRO-002/2.png",
                tallas: ["6", "8", "10", "12", "14"],
                colores: ["azul"],
                descripcion: "Vestido de tul para celebraciones con delicados detalles dorados",
                etiqueta: null,
                enFavoritos: false
            },
            {
                id: 3,
                nombre: "Vestido de Fiesta Azul Celeste",
                categoria: "niñas",
                precio: 0,
                precioAnterior: 0,
                imagen: "FOTO/PRODUCTO/PRO-003/2.png",
                tallas: ["8", "10", "12", "14"],
                colores: ["rosado"],
                descripcion: "Vestido de fiesta con detalles brillantes",
                etiqueta: "nuevo",
                enFavoritos: false
            },
            {
                id: 4,
                nombre: "Vestido Rojo de Terciopelo",
                categoria: "niñas",
                precio: 0,
                precioAnterior: 0,
                imagen: "FOTO/PRODUCTO/PRO-004/2.png",
                tallas: ["6", "8", "10","12"],
                colores: ["rojo"],
                descripcion: "Vestido de terciopelo rojo para fiestas",
                etiqueta: null,
                enFavoritos: false
            }
        ];

        // Datos de asesores 
        const asesores = [
            {
                id: 1,
                nombre: "Grace",
                especialidad: "Asesora de Ventas",
                foto: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ25Qv_2s6K42Qpjs5DvOGkTb07OUbsIpBMsg&s",
                telefono: "+51902308030"
            }
        ];

        // Variables globales
        let productosFiltrados = [...productos];
        let paginaActual = 1;
        const productosPorPagina = 8;
        let productosParaAsesor = [];
        let productosFavoritos = [];
        let busquedaTimeout = null;
        let productoSeleccionadoParaAsesor = null;

        // Estado de los filtros
        const estadoFiltros = {
            categorias: ['niñas', 'niños'],
            tallas: [],
            colores: [],
            precioMaximo: 500,
            busqueda: ''
        };

        // Inicialización cuando el DOM está listo
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar favoritos desde localStorage
            cargarFavoritos();
            
            // Cargar productos para asesor desde localStorage
            cargarProductosAsesor();
            
            // Inicializar componentes
            inicializarFiltros();
            inicializarBusqueda();
            inicializarProductos();
            inicializarModales();
            inicializarMenuMovil();
            inicializarFiltrosMovil();
            
            // Configurar eventos de teclado para accesibilidad
            configurarNavegacionTeclado();
            
            // Configurar scroll para ocultar búsqueda en móvil
            configurarScrollBusquedaMovil();
            
            // Actualizar contadores iniciales
            actualizarContadorFavoritos();
            actualizarContadorAsesor();
            actualizarContadorFiltros();
        });

        // Cargar favoritos desde localStorage
        function cargarFavoritos() {
            const favoritosGuardados = localStorage.getItem('favoritosMigleo');
            if (favoritosGuardados) {
                productosFavoritos = JSON.parse(favoritosGuardados);
            }
        }

        // Guardar favoritos en localStorage
        function guardarFavoritos() {
            localStorage.setItem('favoritosMigleo', JSON.stringify(productosFavoritos));
        }

        // Cargar productos para asesor desde localStorage
        function cargarProductosAsesor() {
            const productosAsesorGuardados = localStorage.getItem('productosAsesorMigleo');
            if (productosAsesorGuardados) {
                productosParaAsesor = JSON.parse(productosAsesorGuardados);
            }
        }

        // Guardar productos para asesor en localStorage
        function guardarProductosAsesor() {
            localStorage.setItem('productosAsesorMigleo', JSON.stringify(productosParaAsesor));
        }

        // Inicializar filtros
        function inicializarFiltros() {
            // Configurar controles de precio
            const deslizadorPrecio = document.getElementById('price-slider');
            const precioMaximoDisplay = document.getElementById('max-price');
            
            if (deslizadorPrecio) {
                deslizadorPrecio.addEventListener('input', function() {
                    const valor = this.value;
                    precioMaximoDisplay.textContent = valor;
                    estadoFiltros.precioMaximo = parseInt(valor);
                    actualizarChipPrecio();
                });
            }
            
            // Configurar opciones de color
            document.querySelectorAll('.color-option').forEach(opcion => {
                opcion.addEventListener('click', function() {
                    const color = this.getAttribute('data-color');
                    alternarFiltroColor(color, this);
                });
                
                opcion.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const color = this.getAttribute('data-color');
                        alternarFiltroColor(color, this);
                    }
                });
            });
            
            // Configurar botones de filtro
            const aplicarFiltrosBtn = document.getElementById('apply-filters');
            const reiniciarFiltrosBtn = document.getElementById('reset-filters');
            
            if (aplicarFiltrosBtn) {
                aplicarFiltrosBtn.addEventListener('click', aplicarFiltros);
            }
            
            if (reiniciarFiltrosBtn) {
                reiniciarFiltrosBtn.addEventListener('click', reiniciarFiltros);
            }
            
            // Configurar checkboxes de categoría y talla
            document.querySelectorAll('input[name="categoria"]').forEach(checkbox => {
                checkbox.addEventListener('change', actualizarFiltroCategoria);
            });
            
            document.querySelectorAll('input[name="talla"]').forEach(checkbox => {
                checkbox.addEventListener('change', actualizarFiltroTalla);
            });
            
            // Configurar acordeón de filtros (solo desktop)
            const filtrosToggle = document.getElementById('filters-toggle');
            const contenidoFiltros = document.getElementById('filters-content');
            
            if (filtrosToggle && contenidoFiltros) {
                const iconoToggle = filtrosToggle.querySelector('.toggle-icon i');
                
                filtrosToggle.addEventListener('click', function() {
                    const estaActivo = contenidoFiltros.classList.toggle('active');
                    iconoToggle.classList.toggle('fa-chevron-down');
                    iconoToggle.classList.toggle('fa-chevron-up');
                    filtrosToggle.setAttribute('aria-expanded', estaActivo);
                });
            }
            
            // Configurar botones de barra de filtros fija
            document.querySelectorAll('.btn-filtro-grupo').forEach(boton => {
                boton.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    mostrarDropdownFiltro(target, this);
                });
            });
            
            // Cerrar dropdowns al hacer clic fuera
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.grupo-filtro-horizontal')) {
                    document.querySelectorAll('.filtro-dropdown').forEach(dropdown => {
                        dropdown.classList.remove('visible');
                    });
                }
            });
            
            // Actualizar chips iniciales
            actualizarChipsFiltros();
        }

        // Inicializar filtros para móvil
        function inicializarFiltrosMovil() {
            // Botón flotante para filtros en móvil
            const btnFiltrosMovil = document.getElementById('btn-filtros-movil');
            if (btnFiltrosMovil) {
                btnFiltrosMovil.addEventListener('click', abrirFiltrosMovil);
            }
            
            // Cargar contenido de filtros en móvil
            cargarFiltrosContentMovil();
        }

        function cargarFiltrosContentMovil() {
            const container = document.getElementById('filtros-content-movil');
            if (!container) return;
            
            let html = `
                <div class="filter-grid">
                    <!-- Categoría -->
                    <div class="filter-group">
                        <h4><i class="fas fa-tags"></i> Categoría</h4>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="categoria-movil" value="niñas" ${estadoFiltros.categorias.includes('niñas') ? 'checked' : ''}>
                                <span>Vestidos para niñas</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="categoria-movil" value="niños" ${estadoFiltros.categorias.includes('niños') ? 'checked' : ''}>
                                <span>Ternos para niños</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Tamaño -->
                    <div class="filter-group">
                        <h4><i class="fas fa-child"></i> Talla</h4>
                        <div class="filter-options">
                            ${['6', '8', '10', '12', '14', '16'].map(talla => `
                                <label class="filter-option">
                                    <input type="checkbox" name="talla-movil" value="${talla}" ${estadoFiltros.tallas.includes(talla) ? 'checked' : ''}>
                                    <span>Talla ${talla}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                    
                    <!-- Precio -->
                    <div class="filter-group">
                        <h4><i class="fas fa-sol"></i> Precio (S/)</h4>
                        <div class="price-filter">
                            <input type="range" min="50" max="500" value="${estadoFiltros.precioMaximo}" class="price-slider" id="price-slider-movil" aria-label="Rango de precios">
                            <div class="price-values">
                                <span>S/ <span id="min-price-movil">50</span></span>
                                <span>S/ <span id="max-price-movil">${estadoFiltros.precioMaximo}</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Color -->
                    <div class="filter-group">
                        <h4><i class="fas fa-palette"></i> Color</h4>
                        <div class="color-options">
                            ${['rosado', 'azul', 'blanco', 'negro', 'rojo', 'amarillo', 'verde', 'multicolor'].map(color => `
                                <div class="color-option ${estadoFiltros.colores.includes(color) ? 'selected' : ''}" 
                                     data-color="${color}" 
                                     onclick="alternarFiltroColorMovil('${color}', this)">
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Configurar eventos para móvil
            const precioSliderMovil = document.getElementById('price-slider-movil');
            if (precioSliderMovil) {
                precioSliderMovil.addEventListener('input', function() {
                    const valor = this.value;
                    document.getElementById('max-price-movil').textContent = valor;
                    estadoFiltros.precioMaximo = parseInt(valor);
                    actualizarChipPrecio();
                });
            }
            
            document.querySelectorAll('input[name="categoria-movil"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const categoria = this.value;
                    const estaMarcado = this.checked;
                    
                    if (estaMarcado) {
                        if (!estadoFiltros.categorias.includes(categoria)) {
                            estadoFiltros.categorias.push(categoria);
                        }
                    } else {
                        const indice = estadoFiltros.categorias.indexOf(categoria);
                        if (indice !== -1) {
                            estadoFiltros.categorias.splice(indice, 1);
                        }
                    }
                    actualizarChipCategorias();
                });
            });
            
            document.querySelectorAll('input[name="talla-movil"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const talla = this.value;
                    const estaMarcado = this.checked;
                    
                    if (estaMarcado) {
                        if (!estadoFiltros.tallas.includes(talla)) {
                            estadoFiltros.tallas.push(talla);
                        }
                    } else {
                        const indice = estadoFiltros.tallas.indexOf(talla);
                        if (indice !== -1) {
                            estadoFiltros.tallas.splice(indice, 1);
                        }
                    }
                    actualizarChipTallas();
                });
            });
        }

        function alternarFiltroColorMovil(color, elemento) {
            elemento.classList.toggle('selected');
            const indice = estadoFiltros.colores.indexOf(color);
            
            if (indice === -1) {
                estadoFiltros.colores.push(color);
            } else {
                estadoFiltros.colores.splice(indice, 1);
            }
            actualizarChipColores();
        }

        function mostrarDropdownFiltro(tipo, boton) {
            // Cerrar otros dropdowns
            document.querySelectorAll('.filtro-dropdown').forEach(d => {
                d.classList.remove('visible');
            });
            
            // Mostrar dropdown correspondiente
            const dropdown = document.getElementById(`dropdown-${tipo}`);
            if (dropdown) {
                dropdown.classList.toggle('visible');
                
                // Posicionar dropdown
                const rect = boton.getBoundingClientRect();
                dropdown.style.left = `${rect.left}px`;
                dropdown.style.top = `${rect.bottom + 5}px`;
            }
        }

        function actualizarFiltroCategoria(e) {
            const categoria = e.target.value;
            const estaMarcado = e.target.checked;
            
            if (estaMarcado) {
                if (!estadoFiltros.categorias.includes(categoria)) {
                    estadoFiltros.categorias.push(categoria);
                }
            } else {
                const indice = estadoFiltros.categorias.indexOf(categoria);
                if (indice !== -1) {
                    estadoFiltros.categorias.splice(indice, 1);
                }
            }
            actualizarChipCategorias();
        }
        
        function actualizarFiltroTalla(e) {
            const talla = e.target.value;
            const estaMarcado = e.target.checked;
            
            if (estaMarcado) {
                if (!estadoFiltros.tallas.includes(talla)) {
                    estadoFiltros.tallas.push(talla);
                }
            } else {
                const indice = estadoFiltros.tallas.indexOf(talla);
                if (indice !== -1) {
                    estadoFiltros.tallas.splice(indice, 1);
                }
            }
            actualizarChipTallas();
        }
        
        function alternarFiltroColor(color, elemento) {
            elemento.classList.toggle('selected');
            const indice = estadoFiltros.colores.indexOf(color);
            
            if (indice === -1) {
                estadoFiltros.colores.push(color);
            } else {
                estadoFiltros.colores.splice(indice, 1);
            }
            actualizarChipColores();
        }

        // Inicializar búsqueda mejorada
        function inicializarBusqueda() {
            const inputBusqueda = document.getElementById('search-input');
            const resultadosBusqueda = document.getElementById('search-results');
            const cargaBusqueda = document.getElementById('search-loading');
            const seccionBusqueda = document.getElementById('search-section');
            const toggleBusquedaMovil = document.getElementById('mobile-search-toggle');
            const menuBusquedaMovil = document.getElementById('mobile-menu-search');
            
            // Búsqueda en tiempo real con debounce
            if (inputBusqueda) {
                inputBusqueda.addEventListener('input', function() {
                    // Mostrar indicador de carga
                    if (cargaBusqueda) cargaBusqueda.classList.add('active');
                    
                    // Limpiar timeout anterior
                    clearTimeout(busquedaTimeout);
                    
                    // Configurar nuevo timeout
                    busquedaTimeout = setTimeout(() => {
                        const consulta = this.value.trim().toLowerCase();
                        
                        if (consulta.length > 0) {
                            estadoFiltros.busqueda = consulta;
                            buscarProductos(consulta);
                        } else {
                            estadoFiltros.busqueda = '';
                            if (resultadosBusqueda) {
                                resultadosBusqueda.classList.remove('active');
                                resultadosBusqueda.innerHTML = '';
                            }
                        }
                        
                        // Ocultar indicador de carga
                        if (cargaBusqueda) cargaBusqueda.classList.remove('active');
                    }, 300);
                });
                
                // Búsqueda al presionar Enter
                inputBusqueda.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        const consulta = this.value.trim().toLowerCase();
                        if (consulta.length > 0) {
                            estadoFiltros.busqueda = consulta;
                            aplicarFiltros();
                            if (resultadosBusqueda) {
                                resultadosBusqueda.classList.remove('active');
                            }
                            
                            // En móvil, cerrar la búsqueda después de buscar
                            if (window.innerWidth < 768 && seccionBusqueda) {
                                setTimeout(() => {
                                    seccionBusqueda.classList.remove('active');
                                }, 500);
                            }
                        }
                    }
                });
                
                // Cerrar resultados al hacer clic fuera
                document.addEventListener('click', function(e) {
                    if (inputBusqueda && !inputBusqueda.contains(e.target) && 
                        resultadosBusqueda && !resultadosBusqueda.contains(e.target)) {
                        resultadosBusqueda.classList.remove('active');
                    }
                });
                
                // Mantener resultados visibles al hacer clic en ellos
                if (resultadosBusqueda) {
                    resultadosBusqueda.addEventListener('click', function(e) {
                        e.stopPropagation();
                    });
                }
            }
            
            // Toggle de búsqueda móvil
            if (toggleBusquedaMovil) {
                toggleBusquedaMovil.addEventListener('click', function() {
                    if (seccionBusqueda) {
                        seccionBusqueda.classList.toggle('active');
                        if (seccionBusqueda.classList.contains('active')) {
                            inputBusqueda.focus();
                        }
                    }
                });
            }
            
            // Búsqueda desde menú móvil
            if (menuBusquedaMovil) {
                menuBusquedaMovil.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (seccionBusqueda) {
                        seccionBusqueda.classList.add('active');
                        setTimeout(() => {
                            if (inputBusqueda) inputBusqueda.focus();
                        }, 100);
                    }
                });
            }
        }

        // Configurar scroll para ocultar búsqueda en móvil
        function configurarScrollBusquedaMovil() {
            let ultimoScroll = 0;
            
            window.addEventListener('scroll', function() {
                if (window.innerWidth < 768) {
                    const seccionBusqueda = document.getElementById('search-section');
                    if (seccionBusqueda && seccionBusqueda.classList.contains('active')) {
                        const scrollActual = window.pageYOffset;
                        
                        // Si el usuario se desplaza más de 50px, ocultar búsqueda
                        if (Math.abs(scrollActual - ultimoScroll) > 50) {
                            seccionBusqueda.classList.remove('active');
                        }
                        
                        ultimoScroll = scrollActual;
                    }
                }
            });
        }

        // Función de búsqueda en tiempo real
        function buscarProductos(consulta) {
            const resultadosBusqueda = document.getElementById('search-results');
            if (!resultadosBusqueda) return;
            
            if (consulta.length < 2) {
                resultadosBusqueda.classList.remove('active');
                resultadosBusqueda.innerHTML = '';
                return;
            }
            
            // Filtrar productos
            const resultados = productos.filter(producto => {
                const enNombre = producto.nombre.toLowerCase().includes(consulta);
                const enDescripcion = producto.descripcion.toLowerCase().includes(consulta);
                const enCategoria = producto.categoria === 'niñas' ? 'vestido' : 'terno';
                
                return enNombre || enDescripcion || enCategoria.includes(consulta);
            }).slice(0, 5);
            
            // Mostrar resultados
            if (resultados.length > 0) {
                let htmlResultados = '';
                
                resultados.forEach(producto => {
                    const categoriaTexto = producto.categoria === 'niñas' ? 'Vestido para niña' : 'Terno para niño';
                    const precioTexto = producto.precio !== null && producto.precio > 0 ? 
                        `S/ ${producto.precio.toFixed(2)}` : 'Consultar precio';
                    
                    htmlResultados += `
                        <div class="search-result-item" data-id="${producto.id}" onclick="verDetallesProducto(${producto.id})">
                            <img src="${producto.imagen}" alt="${producto.nombre}">
                            <div class="search-result-info">
                                <h4>${producto.nombre}</h4>
                                <p>${categoriaTexto}</p>
                                <span class="search-result-price">${precioTexto}</span>
                            </div>
                        </div>
                    `;
                });
                
                resultadosBusqueda.innerHTML = htmlResultados;
                resultadosBusqueda.classList.add('active');
            } else {
                resultadosBusqueda.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                        <p>No se encontraron productos para "${consulta}"</p>
                    </div>
                `;
                resultadosBusqueda.classList.add('active');
            }
        }

        // Aplicar filtros
        function aplicarFiltros() {
            // Filtrar productos
            productosFiltrados = productos.filter(producto => {
                // Filtrar por categoría
                if (estadoFiltros.categorias.length > 0 && !estadoFiltros.categorias.includes(producto.categoria)) {
                    return false;
                }
                
                // Filtrar por talla
                if (estadoFiltros.tallas.length > 0) {
                    const tieneTalla = estadoFiltros.tallas.some(talla => producto.tallas.includes(talla));
                    if (!tieneTalla) return false;
                }
                
                // Filtrar por color
                if (estadoFiltros.colores.length > 0) {
                    const tieneColor = estadoFiltros.colores.some(color => producto.colores.includes(color));
                    if (!tieneColor) return false;
                }
                
                // Filtrar por precio (solo productos con precio mayor a 0)
                if (producto.precio !== null && producto.precio > 0 && producto.precio > estadoFiltros.precioMaximo) return false;
                
                // Filtrar por búsqueda
                if (estadoFiltros.busqueda) {
                    const busquedaMin = estadoFiltros.busqueda.toLowerCase();
                    const enNombre = producto.nombre.toLowerCase().includes(busquedaMin);
                    const enDescripcion = producto.descripcion.toLowerCase().includes(busquedaMin);
                    const enCategoria = producto.categoria === 'niñas' ? 'vestido niña' : 'terno niño';
                    
                    if (!enNombre && !enDescripcion && !enCategoria.includes(busquedaMin)) {
                        return false;
                    }
                }
                
                return true;
            });
            
            // Resetear a primera página
            paginaActual = 1;
            
            // Aplicar ordenamiento actual
            ordenarProductos();
            
            // Actualizar estadísticas
            actualizarEstadisticasProductos();
            
            // Actualizar chips
            actualizarChipsFiltros();
            
            // Cerrar filtros en móvil
            if (window.innerWidth < 768) {
                cerrarFiltrosMovil();
            }
            
            // Mostrar toast de resultados
            mostrarToast(`${productosFiltrados.length} productos encontrados`);
        }

        // Reiniciar filtros
        function reiniciarFiltros() {
            // Resetear estado
            estadoFiltros.categorias = ['niñas', 'niños'];
            estadoFiltros.tallas = [];
            estadoFiltros.colores = [];
            estadoFiltros.precioMaximo = 500;
            estadoFiltros.busqueda = '';
            
            // Resetear UI desktop
            document.querySelectorAll('input[name="categoria"]').forEach(checkbox => {
                checkbox.checked = (checkbox.value === 'niñas' || checkbox.value === 'niños');
            });
            
            document.querySelectorAll('input[name="talla"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            document.querySelectorAll('.color-option').forEach(opcion => {
                opcion.classList.remove('selected');
            });
            
            const precioSlider = document.getElementById('price-slider');
            if (precioSlider) precioSlider.value = 500;
            
            const precioMaximoDisplay = document.getElementById('max-price');
            if (precioMaximoDisplay) precioMaximoDisplay.textContent = '500';
            
            // Resetear UI móvil
            const precioSliderMovil = document.getElementById('price-slider-movil');
            if (precioSliderMovil) precioSliderMovil.value = 500;
            
            const precioMaximoDisplayMovil = document.getElementById('max-price-movil');
            if (precioMaximoDisplayMovil) precioMaximoDisplayMovil.textContent = '500';
            
            // Actualizar filtros móvil
            cargarFiltrosContentMovil();
            
            const inputBusqueda = document.getElementById('search-input');
            if (inputBusqueda) inputBusqueda.value = '';
            
            // Cerrar resultados de búsqueda
            const resultadosBusqueda = document.getElementById('search-results');
            if (resultadosBusqueda) resultadosBusqueda.classList.remove('active');
            
            // Resetear productos
            productosFiltrados = [...productos];
            paginaActual = 1;
            
            // Aplicar orden por defecto
            const sortSelect = document.getElementById('sort-select');
            if (sortSelect) sortSelect.value = 'destacados';
            ordenarProductos();
            
            // Actualizar estadísticas
            actualizarEstadisticasProductos();
            
            // Actualizar chips
            actualizarChipsFiltros();
            
            // Mostrar toast
            mostrarToast('Filtros restablecidos');
            
            // Cerrar búsqueda en móvil
            if (window.innerWidth < 768) {
                const seccionBusqueda = document.getElementById('search-section');
                if (seccionBusqueda) {
                    seccionBusqueda.classList.remove('active');
                }
            }
        }

        // Ordenar productos
        function ordenarProductos() {
            const sortSelect = document.getElementById('sort-select');
            if (!sortSelect) return;
            
            const valorOrden = sortSelect.value;
            
            const productosOrdenados = [...productosFiltrados];
            
            switch(valorOrden) {
                case 'precio-bajo':
                    productosOrdenados.sort((a, b) => {
                        // Productos sin precio o precio 0 van al final
                        if (a.precio === null || a.precio === 0) return 1;
                        if (b.precio === null || b.precio === 0) return -1;
                        return a.precio - b.precio;
                    });
                    break;
                case 'precio-alto':
                    productosOrdenados.sort((a, b) => {
                        // Productos sin precio o precio 0 van al final
                        if (a.precio === null || a.precio === 0) return 1;
                        if (b.precio === null || b.precio === 0) return -1;
                        return b.precio - a.precio;
                    });
                    break;
                case 'nuevos':
                    // Orden inverso por ID (simulando productos nuevos)
                    productosOrdenados.sort((a, b) => b.id - a.id);
                    break;
                case 'destacados':
                default:
                    // Productos con precio primero, luego los de consultar
                    productosOrdenados.sort((a, b) => {
                        if (a.precio > 0 && b.precio === 0) return -1;
                        if (a.precio === 0 && b.precio > 0) return 1;
                        return 0;
                    });
                    break;
            }
            
            productosFiltrados = productosOrdenados;
            renderizarProductos();
        }

        // Inicializar productos
        function inicializarProductos() {
            // Configurar evento de ordenamiento
            const sortSelect = document.getElementById('sort-select');
            if (sortSelect) {
                sortSelect.addEventListener('change', ordenarProductos);
            }
            
            // Renderizar productos iniciales
            renderizarProductos();
        }

        // Renderizar productos
        function renderizarProductos() {
            const gridProductos = document.getElementById('products-grid');
            const paginacion = document.getElementById('pagination');
            
            if (!gridProductos) return;
            
            // Calcular productos para la página actual
            const indiceInicio = (paginaActual - 1) * productosPorPagina;
            const indiceFin = indiceInicio + productosPorPagina;
            const productosPaginados = productosFiltrados.slice(indiceInicio, indiceFin);
            
            // Limpiar grid
            gridProductos.innerHTML = '';
            
            if (productosPaginados.length === 0) {
                gridProductos.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
                        <i class="fas fa-search" style="font-size: 3rem; color: var(--gray-dark); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--text-light); margin-bottom: 10px;">No se encontraron productos</h3>
                        <p style="color: var(--gray-dark);">Intenta con otros filtros o términos de búsqueda</p>
                        <button class="btn btn-primary" onclick="reiniciarFiltros()" style="margin-top: 20px;">
                            <i class="fas fa-redo"></i> Ver todos los productos
                        </button>
                    </div>
                `;
                if (paginacion) paginacion.innerHTML = '';
                return;
            }
            
            // Generar productos
            productosPaginados.forEach(producto => {
                const tarjetaProducto = crearTarjetaProducto(producto);
                gridProductos.appendChild(tarjetaProducto);
            });
            
            // Generar paginación
            renderizarPaginacion();
            
            // Actualizar estadísticas
            actualizarEstadisticasProductos();
        }

        // Crear tarjeta de producto
        function crearTarjetaProducto(producto) {
            const tarjeta = document.createElement('div');
            tarjeta.className = 'product-card';
            tarjeta.setAttribute('data-id', producto.id);
            
            const categoriaTexto = producto.categoria === 'niñas' ? 'Vestido para niña' : 'Terno para niño';
            const textoEtiqueta = producto.etiqueta === 'nuevo' ? 'Nuevo' : 
                                 producto.etiqueta === 'oferta' ? 'Oferta' : 
                                 producto.etiqueta === 'consultar' ? 'Consultar' : '';
            const claseEtiqueta = producto.etiqueta || '';
            const enFavoritos = productosFavoritos.some(fav => fav.id === producto.id);
            
            // MEJORA: Mostrar "Consultar precio" si precio es 0 o null
            const precioTexto = producto.precio !== null && producto.precio > 0 ? 
                `S/ ${producto.precio.toFixed(2)}` : 'Consultar precio';
            
            const precioClase = producto.precio !== null && producto.precio > 0 ? 'product-price' : 'product-price consultar';
            
            // Colores como puntos
            const coloresHTML = producto.colores.map(color => {
                const nombresColores = {
                    'rosado': '#ff6b8b',
                    'azul': '#6a5af9',
                    'blanco': '#ffffff',
                    'negro': '#2d3047',
                    'rojo': '#ff4757',
                    'amarillo': '#ffd700',
                    'verde': '#2ed573',
                    'gris': '#7f8c8d',
                    'multicolor': 'linear-gradient(45deg, #ff6b8b, #6a5af9, #4ecdc4, #2ed573)'
                };
                
                const colorFondo = nombresColores[color] || '#ccc';
                const estilo = color === 'multicolor' ? 
                    `background: ${colorFondo}` : 
                    `background-color: ${colorFondo}`;
                
                return `<div class="product-color-dot" style="${estilo}" title="${color}"></div>`;
            }).join('');
            
            tarjeta.innerHTML = `
                ${textoEtiqueta ? `<div class="product-badge ${claseEtiqueta}">${textoEtiqueta}</div>` : ''}
                
                <div class="product-image-container">
                    <img src="${producto.imagen}" alt="${producto.nombre}" class="product-image" loading="lazy">
                    <button class="product-wishlist ${enFavoritos ? 'activo' : ''}" 
                            aria-label="${enFavoritos ? 'Quitar de favoritos' : 'Añadir a favoritos'}"
                            onclick="alternarFavorito(${producto.id})">
                        <i class="${enFavoritos ? 'fas' : 'far'} fa-heart"></i>
                    </button>
                </div>
                
                <div class="product-info">
                    <span class="product-category">${categoriaTexto}</span>
                    <h3 class="product-title">${producto.nombre}</h3>
                    <p class="product-description">${producto.descripcion}</p>
                    
                    <div class="product-colors">
                        ${coloresHTML}
                    </div>
                    
                    <div class="product-price-container">
                        <span class="${precioClase}">${precioTexto}</span>
                        ${producto.precioAnterior && producto.precio > 0 ? 
                            `<span class="product-price antiguo">S/ ${producto.precioAnterior.toFixed(2)}</span>` : ''}
                    </div>
                    
                    <div class="product-sizes">
                        ${producto.tallas.map(talla => `
                            <span class="size-option" data-size="${talla}">${talla}</span>
                        `).join('')}
                    </div>
                    
                    <div class="product-actions">
                        <!-- MEJORA: Cambiado a "Agregar para consultar" -->
                        <button class="product-btn asesor" onclick="agregarParaAsesorConSeleccion(${producto.id})">
                            <i class="fas fa-plus-circle"></i> Agregar para consultar
                        </button>
                        <button class="product-btn view" onclick="verDetallesProducto(${producto.id})">
                            <i class="fas fa-eye"></i> Ver
                        </button>
                    </div>
                </div>
            `;
            
            // Configurar clic en tallas
            tarjeta.querySelectorAll('.size-option').forEach(opcionTalla => {
                opcionTalla.addEventListener('click', function() {
                    this.classList.toggle('seleccionado');
                });
            });
            
            return tarjeta;
        }

        // Renderizar paginación
        function renderizarPaginacion() {
            const paginacion = document.getElementById('pagination');
            if (!paginacion) return;
            
            const totalPaginas = Math.ceil(productosFiltrados.length / productosPorPagina);
            
            if (totalPaginas <= 1) {
                paginacion.innerHTML = '';
                return;
            }
            
            let htmlPaginacion = '';
            
            // Botón anterior
            htmlPaginacion += `
                <button class="page-btn ${paginaActual === 1 ? 'disabled' : ''}" 
                        onclick="cambiarPagina(${paginaActual - 1})"
                        ${paginaActual === 1 ? 'disabled aria-disabled="true"' : ''}
                        aria-label="Página anterior">
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;
            
            // Páginas
            for (let i = 1; i <= totalPaginas; i++) {
                if (i === 1 || i === totalPaginas || (i >= paginaActual - 1 && i <= paginaActual + 1)) {
                    htmlPaginacion += `
                        <button class="page-btn ${i === paginaActual ? 'active' : ''}" 
                                onclick="cambiarPagina(${i})"
                                aria-label="Página ${i}"
                                ${i === paginaActual ? 'aria-current="page"' : ''}>
                            ${i}
                        </button>
                    `;
                } else if (i === paginaActual - 2 || i === paginaActual + 2) {
                    htmlPaginacion += `<span class="page-btn disabled">...</span>`;
                }
            }
            
            // Botón siguiente
            htmlPaginacion += `
                <button class="page-btn ${paginaActual === totalPaginas ? 'disabled' : ''}" 
                        onclick="cambiarPagina(${paginaActual + 1})"
                        ${paginaActual === totalPaginas ? 'disabled aria-disabled="true"' : ''}
                        aria-label="Página siguiente">
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;
            
            paginacion.innerHTML = htmlPaginacion;
        }

        // Cambiar página
        function cambiarPagina(pagina) {
            const totalPaginas = Math.ceil(productosFiltrados.length / productosPorPagina);
            
            if (pagina < 1 || pagina > totalPaginas || pagina === paginaActual) return;
            
            paginaActual = pagina;
            renderizarProductos();
            
            // Desplazar hacia arriba
            const productsSection = document.getElementById('products');
            if (productsSection) {
                productsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Actualizar estadísticas de productos
        function actualizarEstadisticasProductos() {
            const contadorProductos = document.getElementById('products-count');
            const estadisticasProductos = document.getElementById('products-stats');
            const productosFiltradosCount = document.getElementById('productos-filtrados-count');
            
            if (contadorProductos) {
                contadorProductos.textContent = productosFiltrados.length;
            }
            
            if (estadisticasProductos) {
                const indiceInicio = (paginaActual - 1) * productosPorPagina + 1;
                const indiceFin = Math.min(paginaActual * productosPorPagina, productosFiltrados.length);
                
                if (productosFiltrados.length > 0) {
                    estadisticasProductos.textContent = `Mostrando ${indiceInicio}-${indiceFin} de ${productosFiltrados.length} productos`;
                } else {
                    estadisticasProductos.textContent = 'No hay productos que coincidan';
                }
            }
            
            if (productosFiltradosCount) {
                if (productosFiltrados.length === productos.length) {
                    productosFiltradosCount.textContent = 'Mostrando todos los productos';
                } else {
                    productosFiltradosCount.textContent = `${productosFiltrados.length} productos encontrados`;
                }
            }
        }

        // Inicializar modales
        function inicializarModales() {
            const modalAsesores = document.getElementById('asesores-modal');
            const modalFavoritos = document.getElementById('favoritos-modal');
            
            // Modal de asesores
            document.getElementById('header-asesor').addEventListener('click', abrirModalAsesores);
            document.getElementById('mobile-menu-asesor').addEventListener('click', function(e) {
                e.preventDefault();
                abrirModalAsesores();
            });
            document.getElementById('close-asesores-modal').addEventListener('click', cerrarModalAsesores);
            document.getElementById('cancel-asesor').addEventListener('click', cerrarModalAsesores);
            
            // Modal de favoritos
            document.getElementById('header-favoritos').addEventListener('click', abrirModalFavoritos);
            document.getElementById('mobile-menu-favoritos').addEventListener('click', function(e) {
                e.preventDefault();
                abrirModalFavoritos();
            });
            document.getElementById('close-favoritos-modal').addEventListener('click', cerrarModalFavoritos);
            document.getElementById('contactar-favoritos').addEventListener('click', contactarPorFavoritos);
            document.getElementById('limpiar-favoritos').addEventListener('click', limpiarFavoritos);
            
            // Cerrar modales al hacer clic fuera
            if (modalAsesores) {
                modalAsesores.addEventListener('click', function(e) {
                    if (e.target === modalAsesores) {
                        cerrarModalAsesores();
                    }
                });
            }
            
            if (modalFavoritos) {
                modalFavoritos.addEventListener('click', function(e) {
                    if (e.target === modalFavoritos) {
                        cerrarModalFavoritos();
                    }
                });
            }
            
            // Cerrar con Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (modalAsesores && modalAsesores.classList.contains('activo')) {
                        cerrarModalAsesores();
                    }
                    if (modalFavoritos && modalFavoritos.classList.contains('activo')) {
                        cerrarModalFavoritos();
                    }
                    const detalleModal = document.getElementById('detalle-producto-modal');
                    if (detalleModal && detalleModal.classList.contains('activo')) {
                        cerrarDetalleProductoModal();
                    }
                    const seleccionModal = document.getElementById('seleccion-modal');
                    if (seleccionModal && seleccionModal.classList.contains('activo')) {
                        cerrarSeleccionModal();
                    }
                    const filtrosOverlay = document.getElementById('filtros-overlay');
                    if (filtrosOverlay && filtrosOverlay.classList.contains('activo')) {
                        cerrarFiltrosMovil();
                    }
                }
            });
            
            // Cargar asesores
            cargarAsesores();
            
            // Configurar modal de selección
            const confirmarSeleccionBtn = document.getElementById('confirmar-seleccion');
            if (confirmarSeleccionBtn) {
                confirmarSeleccionBtn.addEventListener('click', confirmarSeleccionProducto);
            }
        }

        // Cargar asesores en el modal
        function cargarAsesores() {
            const listaAsesores = document.getElementById('asesores-list');
            if (!listaAsesores) return;
            
            let htmlAsesores = '';
            
            asesores.forEach(asesor => {
                htmlAsesores += `
                    <div class="asesor-card" data-id="${asesor.id}">
                        <img src="${asesor.foto}" alt="${asesor.nombre}" class="asesor-avatar">
                        <div class="asesor-info">
                            <h4>${asesor.nombre}</h4>
                            <p>${asesor.especialidad}</p>
                        </div>
                        <a href="https://wa.me/${asesor.telefono}?text=${encodeURIComponent(generarMensajeWhatsApp())}" 
                           class="btn-whatsapp" target="_blank" onclick="registrarContactoAsesor(${asesor.id})">
                            <i class="fab fa-whatsapp"></i> Contactar
                        </a>
                    </div>
                `;
            });
            
            listaAsesores.innerHTML = htmlAsesores;
        }

        // Abrir modal de asesores
        function abrirModalAsesores() {
            const modal = document.getElementById('asesores-modal');
            if (!modal) return;
            
            if (productosParaAsesor.length === 0) {
                mostrarToast('Agrega productos para consultar con un asesor');
                return;
            }
            
            // MEJORA: Mostrar productos agregados primero
            actualizarListaProductosConsulta();
            
            modal.classList.add('activo');
            document.body.style.overflow = 'hidden';
        }

        // Cerrar modal de asesores
        function cerrarModalAsesores() {
            const modal = document.getElementById('asesores-modal');
            if (modal) {
                modal.classList.remove('activo');
                document.body.style.overflow = '';
            }
        }

        // Generar mensaje para WhatsApp con todos los productos
        function generarMensajeWhatsApp() {
            let mensaje = "¡Hola! Estoy interesado en los siguientes productos:\n\n";
            
            productosParaAsesor.forEach((item, index) => {
                const producto = productos.find(p => p.id === item.id);
                if (producto) {
                    mensaje += `${index + 1}. ${producto.nombre}\n`;
                    mensaje += `   Talla: ${item.talla || 'No especificada'}\n`;
                    mensaje += `   Color: ${item.color || 'No especificado'}\n\n`;
                }
            });
            
            mensaje += "\nPor favor, contáctame para más información. ¡Gracias!";
            return mensaje;
        }

        // Registrar contacto con asesor
        function registrarContactoAsesor(idAsesor) {
            // Limpiar productos para asesor después de contactar
            productosParaAsesor = [];
            guardarProductosAsesor();
            actualizarContadorAsesor();
            
            cerrarModalAsesores();
            mostrarToast('¡Mensaje preparado para WhatsApp!');
        }

        // Abrir modal de favoritos
        function abrirModalFavoritos() {
            const modal = document.getElementById('favoritos-modal');
            const listaFavoritos = document.getElementById('favoritos-list');
            
            if (!modal || !listaFavoritos) return;
            
            if (productosFavoritos.length === 0) {
                listaFavoritos.innerHTML = `
                    <div class="empty-state">
                        <i class="far fa-heart"></i>
                        <h3>No tienes favoritos aún</h3>
                        <p>Agrega productos a tus favoritos haciendo clic en el corazón</p>
                    </div>
                `;
            } else {
                let htmlFavoritos = '';
                
                productosFavoritos.forEach(id => {
                    const producto = productos.find(p => p.id === id);
                    if (producto) {
                        const precioTexto = producto.precio !== null && producto.precio > 0 ? 
                            `S/ ${producto.precio.toFixed(2)}` : 'Consultar precio';
                        
                        htmlFavoritos += `
                            <div class="favorito-item" data-id="${producto.id}">
                                <img src="${producto.imagen}" alt="${producto.nombre}">
                                <div class="favorito-info">
                                    <h4>${producto.nombre}</h4>
                                    <p>${producto.descripcion}</p>
                                    <span class="favorito-price">${precioTexto}</span>
                                </div>
                                <button class="favorito-remove" onclick="removerDeFavoritos(${producto.id})" aria-label="Eliminar de favoritos">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                    }
                });
                
                listaFavoritos.innerHTML = htmlFavoritos;
            }
            
            modal.classList.add('activo');
            document.body.style.overflow = 'hidden';
        }

        // Cerrar modal de favoritos
        function cerrarModalFavoritos() {
            const modal = document.getElementById('favoritos-modal');
            if (modal) {
                modal.classList.remove('activo');
                document.body.style.overflow = '';
            }
        }

        // Contactar por favoritos
        function contactarPorFavoritos() {
            if (productosFavoritos.length === 0) {
                mostrarToast('No hay productos en favoritos');
                return;
            }
            
            // Mover favoritos a productos para asesor
            productosParaAsesor = productosFavoritos.map(id => {
                const producto = productos.find(p => p.id === id);
                return {
                    id: id,
                    talla: null,
                    color: producto ? producto.colores[0] : null
                };
            });
            
            guardarProductosAsesor();
            actualizarContadorAsesor();
            
            // Abrir modal de asesores
            cerrarModalFavoritos();
            abrirModalAsesores();
        }

        // Limpiar favoritos
        function limpiarFavoritos() {
            productosFavoritos = [];
            guardarFavoritos();
            actualizarContadorFavoritos();
            
            // Actualizar estado en productos
            productos.forEach(producto => {
                producto.enFavoritos = false;
            });
            
            // Cerrar modal y actualizar productos
            cerrarModalFavoritos();
            renderizarProductos();
            
            mostrarToast('Favoritos limpiados');
        }

        // Inicializar menú móvil
        function inicializarMenuMovil() {
            // Configurar ítems activos
            document.querySelectorAll('.mobile-menu-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    if (this.getAttribute('href') === '#') {
                        e.preventDefault();
                    }
                    
                    // Actualizar activo
                    document.querySelectorAll('.mobile-menu-item').forEach(i => {
                        i.classList.remove('active');
                        i.removeAttribute('aria-current');
                    });
                    
                    this.classList.add('active');
                    this.setAttribute('aria-current', 'page');
                });
            });
        }

        // Configurar navegación por teclado
        function configurarNavegacionTeclado() {
            document.addEventListener('keydown', function(e) {
                // Cerrar filtros con Escape
                if (e.key === 'Escape') {
                    const contenidoFiltros = document.getElementById('filters-content');
                    if (contenidoFiltros && contenidoFiltros.classList.contains('active')) {
                        contenidoFiltros.classList.remove('active');
                        const iconoToggle = document.querySelector('.toggle-icon i');
                        if (iconoToggle) {
                            iconoToggle.classList.remove('fa-chevron-up');
                            iconoToggle.classList.add('fa-chevron-down');
                        }
                        const filtrosToggle = document.getElementById('filters-toggle');
                        if (filtrosToggle) {
                            filtrosToggle.setAttribute('aria-expanded', 'false');
                        }
                    }
                }
            });
        }

        // Funciones de interacción del usuario
        function alternarFavorito(idProducto) {
            const producto = productos.find(p => p.id === idProducto);
            if (!producto) return;
            
            const indice = productosFavoritos.indexOf(idProducto);
            
            if (indice === -1) {
                // Añadir a favoritos
                productosFavoritos.push(idProducto);
                producto.enFavoritos = true;
                mostrarToast('Añadido a favoritos');
            } else {
                // Remover de favoritos
                productosFavoritos.splice(indice, 1);
                producto.enFavoritos = false;
                mostrarToast('Eliminado de favoritos');
            }
            
            // Guardar y actualizar
            guardarFavoritos();
            actualizarContadorFavoritos();
            renderizarProductos();
        }

        function removerDeFavoritos(idProducto) {
            const indice = productosFavoritos.indexOf(idProducto);
            
            if (indice !== -1) {
                productosFavoritos.splice(indice, 1);
                
                // Actualizar producto
                const producto = productos.find(p => p.id === idProducto);
                if (producto) {
                    producto.enFavoritos = false;
                }
                
                // Guardar y actualizar
                guardarFavoritos();
                actualizarContadorFavoritos();
                
                // Actualizar modal
                abrirModalFavoritos();
                
                mostrarToast('Eliminado de favoritos');
            }
        }

        // MEJORA: Función para agregar producto con selección de talla y color
        function agregarParaAsesorConSeleccion(idProducto) {
            const producto = productos.find(p => p.id === idProducto);
            if (!producto) return;
            
            productoSeleccionadoParaAsesor = producto;
            
            // Abrir modal de selección
            abrirSeleccionModal(producto);
        }

        function abrirSeleccionModal(producto) {
            const modal = document.getElementById('seleccion-modal');
            const titulo = document.getElementById('seleccion-titulo');
            const tallasContainer = document.getElementById('seleccion-tallas');
            const coloresContainer = document.getElementById('seleccion-colores');
            
            if (!modal || !titulo || !tallasContainer || !coloresContainer) return;
            
            titulo.textContent = `Seleccionar talla y color para: ${producto.nombre}`;
            
            // Cargar tallas
            let tallasHTML = '';
            producto.tallas.forEach(talla => {
                tallasHTML += `
                    <span class="size-option" data-size="${talla}" onclick="seleccionarTalla(this)">${talla}</span>
                `;
            });
            tallasContainer.innerHTML = tallasHTML;
            
            // Cargar colores
            let coloresHTML = '';
            producto.colores.forEach(color => {
                const nombresColores = {
                    'rosado': '#ff6b8b',
                    'azul': '#6a5af9',
                    'blanco': '#ffffff',
                    'negro': '#2d3047',
                    'rojo': '#ff4757',
                    'amarillo': '#ffd700',
                    'verde': '#2ed573',
                    'gris': '#7f8c8d',
                    'multicolor': 'linear-gradient(45deg, #ff6b8b, #6a5af9, #4ecdc4, #2ed573)'
                };
                
                const colorFondo = nombresColores[color] || '#ccc';
                const estilo = color === 'multicolor' ? 
                    `background: ${colorFondo}` : 
                    `background-color: ${colorFondo}`;
                
                coloresHTML += `
                    <div class="color-option" data-color="${color}" style="${estilo}" 
                         onclick="seleccionarColor(this)" title="${color}"></div>
                `;
            });
            coloresContainer.innerHTML = coloresHTML;
            
            modal.classList.add('activo');
            document.body.style.overflow = 'hidden';
        }

        function cerrarSeleccionModal() {
            const modal = document.getElementById('seleccion-modal');
            if (modal) {
                modal.classList.remove('activo');
                document.body.style.overflow = '';
                productoSeleccionadoParaAsesor = null;
            }
        }

        function seleccionarTalla(elemento) {
            // Deseleccionar otras tallas
            elemento.parentNode.querySelectorAll('.size-option').forEach(talla => {
                talla.classList.remove('seleccionado');
            });
            
            // Seleccionar esta talla
            elemento.classList.add('seleccionado');
        }

        function seleccionarColor(elemento) {
            // Deseleccionar otros colores
            elemento.parentNode.querySelectorAll('.color-option').forEach(color => {
                color.classList.remove('selected');
            });
            
            // Seleccionar este color
            elemento.classList.add('selected');
        }

        function confirmarSeleccionProducto() {
            if (!productoSeleccionadoParaAsesor) return;
            
            const tallaSeleccionada = document.querySelector('#seleccion-tallas .size-option.seleccionado');
            const colorSeleccionado = document.querySelector('#seleccion-colores .color-option.selected');
            
            const productoAsesor = {
                id: productoSeleccionadoParaAsesor.id,
                talla: tallaSeleccionada ? tallaSeleccionada.getAttribute('data-size') : null,
                color: colorSeleccionado ? colorSeleccionado.getAttribute('data-color') : null
            };
            
            // Verificar si ya está en la lista
            const indiceExistente = productosParaAsesor.findIndex(item => item.id === productoSeleccionadoParaAsesor.id);
            
            if (indiceExistente !== -1) {
                // Actualizar si ya existe
                productosParaAsesor[indiceExistente] = productoAsesor;
                mostrarToast('Producto actualizado para consulta');
            } else {
                // Añadir nuevo
                productosParaAsesor.push(productoAsesor);
                mostrarToast('Producto agregado para consultar con asesor');
            }
            
            // Guardar y actualizar contador
            guardarProductosAsesor();
            actualizarContadorAsesor();
            
            cerrarSeleccionModal();
        }

        function verDetallesProducto(idProducto) {
            const producto = productos.find(p => p.id === idProducto);
            if (!producto) return;
            
            const categoriaTexto = producto.categoria === 'niñas' ? 'Vestido para niña' : 'Terno para niño';
            const precioTexto = producto.precio !== null && producto.precio > 0 ? 
                `S/ ${producto.precio.toFixed(2)}` : 'Consultar precio';
            const precioAnteriorTexto = producto.precioAnterior ? 
                `S/ ${producto.precioAnterior.toFixed(2)}` : '';
            
            // Colores como texto
            const coloresTexto = producto.colores.map(color => {
                const nombresColores = {
                    'rosado': 'Rosado',
                    'azul': 'Azul',
                    'blanco': 'Blanco',
                    'negro': 'Negro',
                    'rojo': 'Rojo',
                    'amarillo': 'Amarillo',
                    'verde': 'Verde',
                    'gris': 'Gris',
                    'multicolor': 'Multicolor'
                };
                return nombresColores[color] || color;
            }).join(', ');
            
            const modal = document.getElementById('detalle-producto-modal');
            const titulo = document.getElementById('detalle-producto-titulo');
            const contenido = document.getElementById('detalle-producto-contenido');
            
            if (!modal || !titulo || !contenido) return;
            
            titulo.textContent = producto.nombre;
            
            contenido.innerHTML = `
                <div style="display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap;">
                    <img src="${producto.imagen}" alt="${producto.nombre}" 
                         style="width: 200px; height: 200px; object-fit: cover; border-radius: var(--radius-md);">
                    <div style="flex: 1; min-width: 250px;">
                        <p><strong>Categoría:</strong> ${categoriaTexto}</p>
                        <p><strong>Precio:</strong> ${precioTexto} ${precioAnteriorTexto ? `<del>${precioAnteriorTexto}</del>` : ''}</p>
                        <p><strong>Tallas disponibles:</strong> ${producto.tallas.join(', ')}</p>
                        <p><strong>Colores:</strong> ${coloresTexto}</p>
                    </div>
                </div>
                
                <p><strong>Descripción:</strong> ${producto.descripcion}</p>
                
                <div class="filter-actions" style="border-top: none; margin-top: 30px;">
                    <!-- MEJORA: Al hacer clic, abrir modal de asesores -->
                    <button class="filter-btn apply" onclick="agregarParaAsesorConSeleccion(${producto.id}); cerrarDetalleProductoModal()">
                        <i class="fas fa-comments"></i> Consultar con Asesor
                    </button>
                    <button class="filter-btn reset" onclick="cerrarDetalleProductoModal()">
                        <i class="fas fa-times"></i> Cerrar
                    </button>
                </div>
            `;
            
            modal.classList.add('activo');
            document.body.style.overflow = 'hidden';
        }

        function cerrarDetalleProductoModal() {
            const modal = document.getElementById('detalle-producto-modal');
            if (modal) {
                modal.classList.remove('activo');
                document.body.style.overflow = '';
            }
        }

        // Funciones para filtros móvil
        function abrirFiltrosMovil() {
            const overlay = document.getElementById('filtros-overlay');
            if (overlay) {
                overlay.classList.add('activo');
                document.body.style.overflow = 'hidden';
                
                // Actualizar chips en móvil
                actualizarChipsFiltrosMovil();
            }
        }

        function cerrarFiltrosMovil() {
            const overlay = document.getElementById('filtros-overlay');
            if (overlay) {
                overlay.classList.remove('activo');
                document.body.style.overflow = '';
            }
        }

        // Funciones para chips de filtros
        function actualizarChipsFiltros() {
            actualizarChipCategorias();
            actualizarChipTallas();
            actualizarChipPrecio();
            actualizarChipColores();
            actualizarContadorFiltros();
        }

        function actualizarChipsFiltrosMovil() {
            const container = document.getElementById('filtros-chips-movil');
            if (!container) return;
            
            let chipsHTML = '';
            
            // Categorías
            if (estadoFiltros.categorias.length > 0) {
                const texto = estadoFiltros.categorias.map(c => c === 'niñas' ? 'Niñas' : 'Niños').join(', ');
                chipsHTML += crearChipHTML('categorias', texto, 'fas fa-tshirt');
            }
            
            // Tallas
            if (estadoFiltros.tallas.length > 0) {
                chipsHTML += crearChipHTML('tallas', `Tallas: ${estadoFiltros.tallas.join(', ')}`, 'fas fa-child');
            }
            
            // Precio
            if (estadoFiltros.precioMaximo < 500) {
                chipsHTML += crearChipHTML('precio', `Precio hasta: S/ ${estadoFiltros.precioMaximo}`, 'fas fa-sol');
            }
            
            // Colores
            if (estadoFiltros.colores.length > 0) {
                const coloresTexto = estadoFiltros.colores.map(color => {
                    const nombres = {
                        'rosado': 'Rosado',
                        'azul': 'Azul',
                        'blanco': 'Blanco',
                        'negro': 'Negro',
                        'rojo': 'Rojo',
                        'amarillo': 'Amarillo',
                        'verde': 'Verde',
                        'gris': 'Gris',
                        'multicolor': 'Multicolor'
                    };
                    return nombres[color] || color;
                }).join(', ');
                chipsHTML += crearChipHTML('colores', `Colores: ${coloresTexto}`, 'fas fa-palette');
            }
            
            container.innerHTML = chipsHTML;
            
            // Añadir eventos a los chips móviles
            container.querySelectorAll('.filtro-chip').forEach(chip => {
                const tipo = chip.getAttribute('data-tipo');
                chip.querySelector('.chip-remove').addEventListener('click', function() {
                    removerFiltro(tipo);
                });
            });
        }

        function crearChipHTML(tipo, texto, icono) {
            return `
                <div class="filtro-chip" data-tipo="${tipo}">
                    <i class="${icono}" style="font-size: 0.8rem;"></i>
                    <span class="chip-text">${texto}</span>
                    <button class="chip-remove">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
        }

        function actualizarChipCategorias() {
            actualizarChip('categorias', estadoFiltros.categorias.map(c => c === 'niñas' ? 'Niñas' : 'Niños').join(', '), 'fas fa-tshirt');
        }

        function actualizarChipTallas() {
            if (estadoFiltros.tallas.length > 0) {
                actualizarChip('tallas', `Tallas: ${estadoFiltros.tallas.join(', ')}`, 'fas fa-child');
            } else {
                removerChip('tallas');
            }
        }

        function actualizarChipPrecio() {
            if (estadoFiltros.precioMaximo < 500) {
                actualizarChip('precio', `Precio hasta: S/ ${estadoFiltros.precioMaximo}`, 'fas fa-sol');
            } else {
                removerChip('precio');
            }
        }

        function actualizarChipColores() {
            if (estadoFiltros.colores.length > 0) {
                const coloresTexto = estadoFiltros.colores.map(color => {
                    const nombres = {
                        'rosado': 'Rosado',
                        'azul': 'Azul',
                        'blanco': 'Blanco',
                        'negro': 'Negro',
                        'rojo': 'Rojo',
                        'amarillo': 'Amarillo',
                        'verde': 'Verde',
                        'gris': 'Gris',
                        'multicolor': 'Multicolor'
                    };
                    return nombres[color] || color;
                }).join(', ');
                actualizarChip('colores', `Colores: ${coloresTexto}`, 'fas fa-palette');
            } else {
                removerChip('colores');
            }
        }

        function actualizarChip(tipo, texto, icono) {
            const container = document.getElementById('filtros-activos-chips');
            if (!container) return;
            
            let chip = container.querySelector(`[data-tipo="${tipo}"]`);
            
            if (!chip) {
                chip = document.createElement('div');
                chip.className = 'filtro-chip';
                chip.setAttribute('data-tipo', tipo);
                chip.innerHTML = `
                    <i class="${icono}" style="font-size: 0.8rem;"></i>
                    <span class="chip-text">${texto}</span>
                    <button class="chip-remove" onclick="removerFiltro('${tipo}')">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                container.appendChild(chip);
            } else {
                chip.querySelector('.chip-text').textContent = texto;
            }
            
            actualizarContadorFiltros();
        }

        function removerChip(tipo) {
            const container = document.getElementById('filtros-activos-chips');
            if (!container) return;
            
            const chip = container.querySelector(`[data-tipo="${tipo}"]`);
            if (chip) {
                chip.remove();
                actualizarContadorFiltros();
            }
        }

        function removerFiltro(tipo) {
            switch(tipo) {
                case 'categorias':
                    estadoFiltros.categorias = ['niñas', 'niños'];
                    document.querySelectorAll('input[name="categoria"]').forEach(checkbox => {
                        checkbox.checked = (checkbox.value === 'niñas' || checkbox.value === 'niños');
                    });
                    break;
                case 'tallas':
                    estadoFiltros.tallas = [];
                    document.querySelectorAll('input[name="talla"]').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    break;
                case 'precio':
                    estadoFiltros.precioMaximo = 500;
                    const precioSlider = document.getElementById('price-slider');
                    if (precioSlider) precioSlider.value = 500;
                    const precioMaximoDisplay = document.getElementById('max-price');
                    if (precioMaximoDisplay) precioMaximoDisplay.textContent = '500';
                    break;
                case 'colores':
                    estadoFiltros.colores = [];
                    document.querySelectorAll('.color-option').forEach(opcion => {
                        opcion.classList.remove('selected');
                    });
                    break;
            }
            
            aplicarFiltros();
        }

        function limpiarTodosFiltros() {
            reiniciarFiltros();
        }

        function actualizarContadorFiltros() {
            const contador = document.getElementById('contador-filtros-movil');
            if (!contador) return;
            
            let count = 0;
            if (estadoFiltros.categorias.length < 2) count++;
            if (estadoFiltros.tallas.length > 0) count++;
            if (estadoFiltros.precioMaximo < 500) count++;
            if (estadoFiltros.colores.length > 0) count++;
            
            contador.textContent = count;
        }

        // Actualizar lista de productos para consulta en modal
        function actualizarListaProductosConsulta() {
            const container = document.getElementById('lista-productos-consulta');
            if (!container) return;
            
            if (productosParaAsesor.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light);">No hay productos agregados</p>';
                return;
            }
            
            let html = '';
            
            productosParaAsesor.forEach((item, index) => {
                const producto = productos.find(p => p.id === item.id);
                if (producto) {
                    html += `
                        <div class="producto-consulta-item">
                            <img src="${producto.imagen}" alt="${producto.nombre}">
                            <div class="producto-consulta-info">
                                <h5>${producto.nombre}</h5>
                                <p>Talla: ${item.talla || 'No especificada'} | Color: ${item.color || 'No especificado'}</p>
                            </div>
                            <button class="producto-consulta-remover" onclick="removerProductoConsulta(${index})">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                }
            });
            
            container.innerHTML = html;
        }

        function removerProductoConsulta(index) {
            productosParaAsesor.splice(index, 1);
            guardarProductosAsesor();
            actualizarContadorAsesor();
            actualizarListaProductosConsulta();
            
            if (productosParaAsesor.length === 0) {
                cerrarModalAsesores();
            }
        }

        // Funciones de utilidad
        function actualizarContadorFavoritos() {
            const contadorFavoritos = document.getElementById('favoritos-count');
            const contadorFavoritosMovil = document.getElementById('mobile-favoritos-count');
            
            if (contadorFavoritos) {
                contadorFavoritos.textContent = productosFavoritos.length;
            }
            
            if (contadorFavoritosMovil) {
                contadorFavoritosMovil.textContent = productosFavoritos.length;
            }
        }

        function actualizarContadorAsesor() {
            const contadorAsesor = document.getElementById('asesor-count');
            const contadorAsesorMovil = document.getElementById('mobile-asesor-count');
            
            if (contadorAsesor) {
                contadorAsesor.textContent = productosParaAsesor.length;
            }
            
            if (contadorAsesorMovil) {
                contadorAsesorMovil.textContent = productosParaAsesor.length;
            }
        }

        function mostrarToast(mensaje) {
            // Eliminar toast existente
            const toastExistente = document.querySelector('.toast');
            if (toastExistente) {
                toastExistente.remove();
            }
            
            // Crear nuevo toast
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.setAttribute('role', 'alert');
            toast.setAttribute('aria-live', 'polite');
            toast.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <span>${mensaje}</span>
            `;
            
            document.body.appendChild(toast);
            
            // Eliminar después de 3 segundos
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 3000);
        }
    </script>
</body>
</html>
